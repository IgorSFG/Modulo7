<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokelist</title>
</head>

<body>
    <input type="text" id="name" placeholder="Nome do Pokemon">
    <input type="file" id="image">
    
    <button id="send">Enviar</button>
    <button id="update">Atualizar</button>
    <button id="delete">Deletar</button>
    <br>

    <ul id="data-list"></ul>
    
</body>

<script>
// Get references to the buttons
const sendButton = document.getElementById("send");
const updateButton = document.getElementById("update");
const deleteButton = document.getElementById("delete");

// Add event listeners to the buttons
sendButton.addEventListener("click", () => Pokemon('post'));
updateButton.addEventListener("click", () => Pokemon('put'));
deleteButton.addEventListener("click", () => Pokemon('delete'));

function Pokemon(action) {
    const image_input = document.getElementById("image");
    const name = document.getElementById("name").value;
    
    if (image_input.files.length != 0 && name != "") {
      
        const file = image_input.files[0];
        const reader = new FileReader();

        reader.onloadend = () => {
            const image64 = reader.result;
            console.log(name);
            console.log(image64);
            Pokedex(action, name, image64);
        }

        reader.readAsDataURL(file);
    }

    else if (action == 'delete' && name != "") {
        Pokedex(action, name, null);
    }
};

function Pokedex(action, name, image64) {
    console.log(action);
    fetch(`/${action}Pokemon`, {
        method: action.toUpperCase(),
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            name: name,
            image: image64 //essa poha dÃ¡ erro
        })
    })
    .then(response => response.json())
    .then(responseData => console.log('Response data:', responseData))
    .catch(error => console.error('Fetch error:', error));
}
    
fetch('/getPokemon')
    .then(response => response.json())
    .then(data => {
    const dataList = document.getElementById('data-list');
    data.forEach(item => {
        const listItem = document.createElement('li');
        listItem.textContent = item;
        dataList.appendChild(listItem);
});
});
</script>

</html>